<!DOCTYPE html>
<html lang="en">
<body>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.6/angular.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.6/angular-sanitize.js"></script>
<script>
    var app = angular.module('myApp', ['ngSanitize']);
    app.controller('ChatSend', function($scope, $http) {
        $scope.username = "";
        $scope.msg = "";
        $scope.algo = function () { return $scope.username };
        $scope.algo2 = function () { return $scope.msg };
        $scope.sendMsg = function () {
            $http.post('/api/chat', {username:$scope.algo(), msg:$scope.algo2()});
        }
    });
    app.controller('ChatRecv', function ($scope, $http, $timeout) {
        $scope.lista = [];
        var retrieve = function() {
            $http.get('/api/chat').then(function (response) {
                $scope.lista = response.data;
                $timeout(retrieve, 500);
            });
        };
        retrieve();
    })
</script>
<div class="container" ng-app="myApp">
<form class="form-horizontal">
    <div class="form-group" ng-controller="ChatSend">
        <label>Username</label>
        <input type="text" ng-model="username">
        <label>msg</label>
        <input type="text" ng-model="msg">
        <button ng-click="sendMsg()" class="btn btn-primary">Submit</button>
    </div>
</form>
<div ng-controller='ChatRecv'>
    <script>document.getElementById("display").innerHTML = "{{msg}}"</script>
    <table>
        <tr>
            <th>user</th>
            <th>msg</th>
        </tr>
        <tr ng-repeat="i in lista">
            <td>{{ i.username }}</td>
            <td>{{ i.msg }}</td>
        </tr>
    </table>
</div>
</div>

</body>
</html>
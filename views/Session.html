<!DOCTYPE html>
<html>
<script src="js/angular.min.js"></script>
<script src="js/angular-sanitize.js"></script>
<script src="js/Chart.min.js"></script>
<script src="js/angular-chart.min.js"></script>
<script src="js/angular-animate.js"></script>
<script src="js/ui-bootstrap-2.5.0.min.js"></script>
<script>
    var usernamelogged = "<%= session.username %>";
    var url = "<%= url %>";
    var reslen = parseInt("<%= resultado.length %>");
    var sessionId = "<%= sessionId %>";
    var stages = [
        <%for (var i = 0; i < resultado.length; i++) {%>
        ["<%= resultado[i].titulo %>","<%= resultado[i].descripcion %>","<%= resultado[i].id %>"],
        <%}%>];
</script>

<script src="js/chat_rest.js"></script>
<script src="/socket.io/socket.io.js"></script>
<% include ../partials/header %>
<body>
<div id="start" class="start"></div>
<div class="maxwidth1050"></div>
<% include ../partials/nav %>
<section id="hero" class="hero" data-ng-app="myApp">
    <div class="hero__gradient"></div>
    <div class="hero__pattern"></div>
    <div class="hero__content">
        <div class="hero__content-wrapper">
            <div class="container col-md-9 pull-left" data-ng-controller="Stages">
                <div style="display:inline-flex;padding-bottom: 10px;width:100%">
                    <h1 class="clabel" style="position: absolute"><a href="/sessions"></a> <%= name %></h1>
                    <div style="width:100%;position: relative">
                        <button class="btn" data-ng-click="show()" style=";position:relative;float: right">Compartir</button>
                    </div>
                </div>
                <div style="background-color: rgba(0,0,0,0.2);border-radius: 20px;padding: 10px 0 15px 5px">
                    <div style="width:100%;height:100px; display:inline-flex">
                        <div class="left-arrow" data-ng-click="left()"><i class="fa fa-arrow-left"></i></div>
                        <div style="width: calc(100% - 40px); height:100%; margin: 0 auto; display: block; float:none">
                            <div class="image" data-ng-class="mostrar"></div>
                            <div class="name" data-ng-class="mostrar">Nombre: {{ actualName }}</div>
                            <div class="name desc" data-ng-class="mostrar">Descripcion: {{ actualDesc }}</div>
                                <div style="display:flex;align-items: center;height:100%;justify-content: center"><button style="width:100px;height:50px;transition: all ease 0.2s;"
                                    data-ng-class="mostrar" class="btn" data-ng-click="sendVoto()">
                                    Votar
                                </button></div>
                        </div>
                        <div class="right-arrow" data-ng-click="right()"><i class="fa fa-arrow-right"></i></div>
                    </div>
                </div>
                <div style="padding-top:10px">
                    <div style="text-align: center">
                        <div data-ng-repeat="k in form" style="display:inline-flex;">
                            <div class="card" style="" data-ng-click="fooVoto(k.id-1)">
                                <p class="clabel">{{ k.name }}</p>
                                <div style="float: right;color:white">{{priorities[k.id-1][1]}}</div>
                                <div style="height:100%;width:calc(15 * 3);margin: 0 auto; display: inline-flex;">
                                    <button class="btn btn-success" id="btnPriority" data-ng-click="addPriority(k.id-1,1)"></button>
                                    <button class="btn btn-warning" id="btnPriority" data-ng-click="addPriority(k.id-1,2)"></button>
                                    <button class="btn btn-danger" id="btnPriority" data-ng-click="addPriority(k.id-1,3)"></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!--<button data-ng-click="showAModal()" class="btn btn-primary">hola</button>-->
            </div>
            <div class="container col-md-3 pull-right" style="padding-top:20px;background-color:rgba(0,0,0,0.2);border-radius: 10px;padding-bottom: 20px">
                <div data-ng-controller='Timer' style="text-align:center;padding-bottom:10px">
                    <% if(hostId == session.userId) { %>
                    <p class="clabel" style="font-size:1.2em">{{ minutes() }} minutos {{ timer%60 }} segundos</p>
                    <button class="btn btn-success" id="btnTimer" data-ng-click='addTime()'>+5</button>
                    <button class="btn btn-primary" id="btnTimer" data-ng-click='starting()'>
                        <i class="fa fa-play"></i>
                    </button>
                    <button class="btn btn-danger" id="btnTimer" data-ng-click='sit()'>
                        <i class="fa fa-stop"></i>
                    </button>
                    <button class="btn btn-warning" id="btnTimer" data-ng-click='resetTime()'>
                        <i class="fa fa-refresh"></i>
                    </button>
                    <% } else { %>
                    <script>
                        var socket = io.connect('http://localhost:3000');
                        socket.on('timer', function (dat) {
                            document.getElementById("timerId").innerHTML =
                            '<p>' + dat.min + ' minutos '+ dat.seg+ ' segundos '+'<\p>' ;
                        });
                    </script>
                    <label class="clabel" id="timerId"></label>
                    <% } %>
                </div>
                <div style="display: inline-flex" data-ng-controller='ChatSend'>
                    <input class="btn" style="background-color: rgba(10,10,10,0.2);width: 100%;color:white; text-align:left" id="message" type="text" data-ng-model="msg" />
                    <button data-ng-click="sendMsg()" class="btn btn-primary" id="btnTimer">
                        <i class="fa fa-paper-plane"></i>
                    </button>
                </div>
                <div data-ng-controller='ChatRecv'>
                    <div style="width:100%">
                        <div style="width:100%" data-ng-repeat="i in lista">
                            <p class="msg">{{ i.username }}: {{ i.msg }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>


    </div>
    <!--
    <div class="graph" ng-controller="BarChart" >
        <canvas id="bar" class="chart-horizontal-bar"
                chart-data="data" chart-labels="labels">
        </canvas>
    </div> -->
</section>
</body>
</html>
